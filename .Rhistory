prosoc_left = factor(prosoc_left))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_line(aes(y = proportion, group = prosoc_left, color = "raw"),
linewidth = 1/4) +
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
# # for annotation
# text <-
#   distinct(d, labels) %>%
#   mutate(actor = 1,
#          prop  = c(.07, .8, .08, .795))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_line(aes(y = proportion, group = prosoc_left, color = "raw"),
linewidth = 1/4) +
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
# # for annotation
# text <-
#   distinct(d, labels) %>%
#   mutate(actor = 1,
#          prop  = c(.07, .8, .08, .795))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_line(aes(y = proportion, group = prosoc_left, color = "raw"),
linewidth = 1/4) +
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
# # for annotation
# text <-
#   distinct(d, labels) %>%
#   mutate(actor = 1,
#          prop  = c(.07, .8, .08, .795))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
# geom_line(aes(y = proportion, group = prosoc_left, color = "raw"),
#           linewidth = 1/4) +
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
# # for annotation
# text <-
#   distinct(d, labels) %>%
#   mutate(actor = 1,
#          prop  = c(.07, .8, .08, .795))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
# geom_line(aes(y = proportion, group = prosoc_left, color = "raw"),
#           linewidth = 1/4) +
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = NULL, size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
# # for annotation
# text <-
#   distinct(d, labels) %>%
#   mutate(actor = 1,
#          prop  = c(.07, .8, .08, .795))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
# geom_line(aes(y = proportion, group = prosoc_left, color = "raw"),
#           linewidth = 1/4) +
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
# for annotation
text <-
distinct(d, labels) %>%
mutate(actor = 1,
prop  = c(.07, .8, .08, .795))
#| code-fold: true
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# for annotation
text <-
distinct(d, labels) %>%
mutate(actor = 1,
prop  = c(.07, .8, .08, .795))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
geom_text(data = text,
aes(y = prop, label = labels),
color = "#DCA258", size = 3) +
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
#| code-fold: true
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# for annotation
text <-
distinct(d, labels) %>%
mutate(actor = 1,
prop  = c(.07, .8, .08, .795))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
geom_text(data = text,
aes(y = prop, label = labels), size = 3) +
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
#| code-fold: true
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# for annotation
text <-
distinct(d, labels) %>%
mutate(actor = 1,
prop  = c(.07, .8, .08, .795))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
geom_text(data = text,
aes(y = prop, label = labels), size = 3) +
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL, breaks=NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
#| code-fold: true
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# for annotation
text <-
distinct(d, labels) %>%
mutate(actor = 1,
prop  = c(.07, .8, .08, .795))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
geom_text(data = text,
aes(y = prop, label = labels), size = 9) +
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL, breaks=NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
#| code-fold: true
d$labels = factor(d$treatment, 1:4, labels=c("r/n", "l/n", "r/p", "l/p"))
nd <-
d %>%
distinct(actor, condition, labels, prosoc_left, treatment) %>%
mutate(block = 5)
# compute and wrangle the posterior predictions
nd = fitted(m4,
newdata = nd) %>%
data.frame() %>%
bind_cols(nd) %>%
# add the empirical proportions
left_join(
d %>%
group_by(actor, treatment) %>%
mutate(proportion = mean(pulled_left)) %>%
distinct(actor, treatment, proportion),
by = c("actor", "treatment")
) %>%
mutate(condition = factor(condition),
prosoc_left = factor(prosoc_left))
# for annotation
text <-
distinct(d, labels) %>%
mutate(actor = 1,
prop  = c(.07, .8, .08, .795))
# plot!
nd %>% ggplot(aes(x = labels)) +
geom_hline(yintercept = .5,  alpha = 1/2, linetype = 2) +
# empirical proportions
geom_point(aes(y = proportion, shape = condition, color = "raw"),
fill = "white", size = 2.5, show.legend = F) +
# posterior predictions
geom_line(aes(y = Estimate, group = prosoc_left, color = "model"),
linewidth = 3/4) +
geom_pointrange(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5, shape = condition,
color = "model"),
fill = "white", fatten = 8, linewidth = 1/3, show.legend = F) +
# annotation for the conditions
geom_text(data = text,
aes(y = prop, label = labels), size = 5) +
guides(color = FALSE) +
scale_shape_manual(values = c(21, 19)) +
scale_color_manual(values = c("#1c5253", "black")) +
scale_x_discrete(NULL, breaks=NULL) +
scale_y_continuous("proportion left lever",
breaks = 0:2 / 2,
labels = c("0", ".5", "1"))  +
facet_wrap(~ actor, nrow = 1, labeller = label_both)
